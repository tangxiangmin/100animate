<!DOCTYPE html>
<!--
	作者：tangxiangmin@126.com
	时间：2016-08-07
	描述：先用面向过程写一遍吧
		08-07：今天完成界面布局
		08-10: 初始化食物与蛇头，及随机产生食物 
-->
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<link rel="stylesheet" href="../css/style.css"/>
		<style rel="stylesheet">
			.box { position: relative; }
			.map {border-collapse: collapse;}
			.map td { width: 20px; height: 20px; border: 1px solid #dedede; box-sizing: border-box;}
			.snake { width: 100%;height: 100%; position: absolute;top: 0; left: 0;z-index: 10; }
			.food , .snakeNode,.snakeHead {width: 20px; height: 20px; position: absolute;}
			.snakeNode { background: #000; left: 0; top: 0; }
			.food { background: blue; }
			.snakeHead { background: red;}
			
			
			.score { float: right; width: 100px; height: 100px ; }
			
		</style>
	</head>
	<body>
		<h1>简易版贪吃蛇</h1>
		<p>
			<a href="../index.html">返回主菜单</a>
		</p>
		<div class="wrap">
			<div class="score">
				分数：<span>0</span>
			</div>
			<div class="box">
				<table class="map">
					<tbody>
						<tr></tr>
					</tbody>
				</table>
				<ul class="snake">
					<li class="snakeHead"></li>
				</ul>
				<div class="food"></div>
				
			</div>
		</div>
		
		
	
		<!--华丽丽的分割线-->
		<script src="../js/jquery-1.12.4.min.js"></script>
		<script>
			$(function(){
				//行列
				var row = 10; 
				var col = 10;
				var w = 20;
				var h = 20;
				
				var score = 0;
				createTable(row,col);
				//创建地图
				function createTable(row,col){
					var strTr = "";
					for (var i = 0; i < row; ++i){
						strTr += "<tr></tr>";
					}
					$(".map").append(strTr);
					$(".map tr").each(function(){
						var strTd = "";
						for (var i = 0; i < col; ++i){
							strTd += "<td></td>";
						}
						$(this).append(strTd);
					})
				}
				//初始化位置
				createFood();
				function randPos(){
					var startX = Math.floor(Math.random()*row)*w+"px";
					var startY = Math.floor(Math.random()*col)*h+"px";
					return {
						x:startX,
						y:startY
					};
				}
				
				var headPos = randPos();
				$(".snakeHead").css({"left":headPos.x,"top":headPos.y});
		
				$(document).on("keydown",function(e){
					var timer = null;
					switch (e.which){
						case 37:
							$(".snakeHead").css("left","-=20px");
							break;
						case 38:
							$(".snakeHead").css("top","-=20px");
							break;
						case 39:
							$(".snakeHead").css("left","+=20px");
							break;
						case 40:
							$(".snakeHead").css("top","+=20px");
							break;
						default:
							break;
					};
					CheckMeet();
				})
				
				function CheckMeet(){
					var snakeHead = getPos($(".snakeHead"));
					var food = getPos($(".food"));
					if (snakeHead.x == food.x && snakeHead.y == food.y){
						score += 10;
						$(".score span").text(score);
						createFood();
					}
				}
				function getPos(obj){
					return {
						x:obj.position().left/w,
						y:obj.position().top/h
					}
				}
				
				function createFood(){
					var foodPos = randPos();
					$(".food").css({"left":foodPos.x,"top":foodPos.y});
				}
				
			})
		</script>
	</body>
</html>
